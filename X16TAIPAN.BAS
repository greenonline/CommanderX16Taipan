2 REM COMMANDERX16TAIPAN
3 SCREEN 3

5 REM INITIALIZATION (10-50)
11 B$="                                       "
10 A$ = "                                        "
12 W$ = "ELDER BROTHER WU":LY$ = "LI YUEN"
14 YS$ = "YANATO & SMYTHE":TC$ = "O, S, T, A, P, OR R"

20 LOCATE 1,4:INVERS=1:PRINT A$:
21 LOCATE 13,5: PRINT "T A I P A N:":NRMAL=1
22 LOCATE 13,6: PRINT "-----------------"
23 SPEED = 100: LOCATE14,9:PRINT"A  G A M E  I N":
24 PRINT TAB(15);"C O N T E X T": PRINT:PRINT TAB( 14);"HAYDEN BOOK CO."
25 SPEED = 255:INVERS=1:PRINT TAB(15) A$:NRMAL=1

30 DIM M$(11),G$(5),AP(9,5),GG(5),L(9,5),GP(5),V(9)
31 FOR I = 0 TO 9:READ L$(I):NEXT I
32 FOR I = 0 TO 11: READ M$(I):NEXT I
33 FOR I = 0 TO 5: READ G$(I):NEXT I


40 FOR I = 0 TO 9
41 FOR J = 0 TO 5:READ AP(I,J):AP(I,J) = AP(I,J) * 6 ^ (5 - J): NEXT J
42 NEXT I : GOSUB 180
42 NEXT I 
43 GOSUB 180


50 FOR I = 0 TO 9:READ LO(I):NEXT I
51 D = 1000: Y=1860: GT = 1: C=400:MW = 50:SH = MW:SR = 1: G=1:V(0) = 1
52 GOSUB 5000: X$ ="":GOSUB 590:GOTO 120

55 REM GET$ SUBROUTINE (60-64)
60 REM POKE -16368, 0
61 REM IF PEEK ( -16384) < 128 THEN 61
62 REM X$ = CHR$ ( PEEK ( -16384) - 128)
63 REM POKE -16368, 0
64 GET X$: RETURN

65 REM INITIALIZATION DATA (70-110)
70 DATA HONGKONG, FOOCHOU, SHANGHAI, NAGASAKI, MANILA
71 DATA SINGAPORE, BATAVIA, SAIGON, CALCUTTA, LIVERPOOL

80 DATA JAN, FEB, MAR, APR, MAY, JUN
81 DATA JUL, AUG, SEP, OCT, NOV, DEC
90 DATA OPIUM, SILK, TEA, ARMS, PEPPER, RICE
100 DATA 8,2,2,4,5,2,8,2,1,8,4,3,9,3
101 DATA 3,6,5,4,6,4,2,8,6,5,3,3,4,7,4,4
102 DATA 2,4,5,4,3,5,3,4,5,5,2,6,3
103 DATA 1,4,5,3,3,1,5,6,3,4,5,3,9,9,1,9,5
110 DATA 21,14,7,0,35,49,56,42,84,200


115 REM MAIN DISPLAY (120-150)
120 GOSUB 130: GOTO 220
130 LOCATE 1,1:PRINT "PORT ";L$(L);: LOCATE 29,2:PRINTM$(M);". ";DA+1;",";Y


140 LOCATE 1,2: INVERS=1:PRINT "CASH ";: Q = C:GOSUB 1330: NRMAL=1
141 LOCATE1,2:PRINT TAB(28);"GUNS ";G: LOCATE 1,3:PRINT "DEBT ";
142 Q = D:GOSUB 1330:LOCATE 28,3:PRINT "HOLD ";: Q = SH:GOSUB 1330
143 LOCATE1,4:INVERS=1:PRINT "GOODS     ABOARD SHIP    HONGKONG GODOWN":NRMAL=1

150 FOR I = 0 TO 5: LOCATE 1,5 + I:PRINT G$(I)
151 LOCATE 11, 5 + I:PRINT CHR$(133);
152 Q=SG(I):GOSUB 1330:LOCATE 26, 5 + I:PRINT CHR$ (133);: Q = GG(I):GOSUB 1330
153 NEXT I
154 INVERS=1: PRINT A$: NRMAL=1: RETURN



155 REM UPDATE SUBROUTINE (160-172)
160 ET = INT (ET + (ET * RND (1) / 3)): GT = GT + ET
161 D = D + INT (D * (ET / 360)):JD = JD + ET
162 IF JD > 360 THEN JD = JD-360: Y=Y+1
163 IFJD<1THENJD=1
170 M=INT((JD - 30) / 30): DA = INT((((JD / 30) -INT(JD/30)))*30)
171 IF RND (1) > 0.95 THEN TR = 0



172 IF M < 0 THEN M = 0
173 RETURN

175 REM PRICE VARIATION SUBROUTINE (180)
180 FOR I = 0 TO 5:GP(I) = INT (AP(L,I) + ( RND (1) * AP(L,I))):NEXT I: RETURN



185 REM HI-LO SUBROUTINE (190-210)
190 FOR I = 0 TO 5:IF GP(I) > H(L,I) THEN H(L,I) = GP(I)
200 IFGP(I)<L(L,I)ORL(L,I)=0THENL(L,I)= GP (I)
210 NEXT I: RETURN

212 REM MARKET (220-350)
217 REM MARKET PRICES (220-221)
220 GOSUB 790: GOSUB 1340:LOCATE 1,11:INVERS=1:
221 PRINT TAB(8) " ";L$(L);" MARKET PRICES ":NRMAL=1:PRINT A$
222 FOR I = 0 TO 4 STEP 2: LOCATE 1,13 + I / 2:PRINT G$(I);
223 PRINT TAB(10); GP(I) ;:PRINT TAB(21); G$(I + 1);
224 PRINT TAB(30);GP(I + 1) :NEXT I
225 REM MARKET MENU (230-244)
230 PRINT: LOCATE 1,18:PRINT " B)UY, S)ELL, L)EAVE, OR R)ETIRE?" 
235 REM MARKET MENU INPUT (240-244)


240 GOSUB 60: IF X$= "B" THEN T$ = "BUY":X=1
241 IF X$= "S" THEN T$ = "SELL":X=2

242 IF X$="L" THEN 360
243 IF X$ = "R" THEN 1300
244 IF X$<>"B" AND X$<>"S" AND X$<>"L" AND X$<>"R" THEN GOSUB 770:GOTO 240
247 REM ITEM MENU (250)
250 LOCATE 1,18:PRINT A$;:LOCATE 3,18:PRINT T$;" ";TC$;"?": GOSUB 260:GOTO 280
255 REM ITEM CHOICE SUBROUTINE (260-270)
260 GOSUB 60:IF X$ = "O" THEN X1 = 0
261 IF X$ = "S" THEN X1 = 1
262 IF X$ = "A" THEN X1 = 3 
263 IF X$ = "P" THEN X1 = 4 
265 IF X$ = "R" THEN X1 = 5

268 IFX$<>"O"ANDX$<>"S"ANDX$<>"T"ANDX$<>"A"ANDX$<>"P"ANDX$<>"R"THENGOSUB770
269 IFX$<>"O"ANDX$<>"S"ANDX$<>"T"ANDX$<>"A"ANDX$<>"P"ANDX$<>"R"THEN GOTO260


270 RETURN

280 IF X=1 AND GP(X1) > C THEN LOCATE 1,18
281 IF X=1 AND GP(X1) > C THEN PRINT "YOU CAN'T AFFORD ANY ";G$(X1);". ";
282 IF X=1 AND GP(X1) > C THEN GOSUB 760:GOTO 230

290 IF X = 2 AND SG(X1) < 1 THEN LOCATE 1,18
291 IF X = 2 AND SG(X1) < 1 THEN PRINT "YOU HAVE NO ";G$(X1); " ABOARD!      ";
292 IF X = 2 AND SG(X1) < 1 THEN GOSUB 760:GOTO 230
300 LOCATE 1,18: PRINT A$;:LOCATE 1,18:PRINT T$;" HOW MUCH ";G$(X1);
301 PRINT "? ";:NUM$ = "":NUM = 0:GOSUB 305:GOTO 320
305 REM SOOPER DOOPER NUMBER SCOOPER SUBROUTINE (310-314)
306 PRINT CHR$ (8);: INVERS=1:PRINT " ";:NRMAL=1:GOSUB 60
307 IF LEN(NUM$) > 0 AND ASC(X$) = 8 THEN PRINT X$;: PRINT" "; 
308 IF LEN(NUM$) > 0 AND ASC(X$) = 8 THEN PRINT X$;X$;:PRINT" ";:FG=1
309 IF LEN(NUM$) > 0 AND ASC(X$) = 8 AND LEN(NUM$) = 1 THEN NUM$ = "": FG = 0
310 IF LEN(NUM$) > 0 AND ASC(X$) = 8 AND LEN(NUM$) = 1 THEN GOTO 305

311 IF FG = 1 THEN NUM$ = LEFT$ (NUM$, LEN (NUM$) - 1):FG = 0: GOTO 305
312 IF ASC (X$) = 65 OR ASC (X$) = 13 THEN RETURN
313 IF ASC (X$) < 48 OR ASC (X$) > 57 THEN 305
314 NUM$ = NUM$ + X$: PRINT CHR$ (8);X$; 
315 INVERS=1:PRINT " ";:NRMAL=1: GOTO 305
320 IF X= 1 THEN IF X$ = "A" THEN PRINT CHR$ (8);: INVERS=1
321 IF X= 1 THEN IF X$ = "A" THEN PRINT "ALL"; :NUM = INT (C / GP(X1))
322 IF X = 1 AND X$ <> "A" THEN NUM = VAL (NUM$)
330 IF X = 2 THEN IF X$ = "A" THEN PRINT CHR$ (8) ; : INVERS=1
331 IF X = 2 THEN IF X$ = "A" THEN PRINT "ALL";:NUM = SG(X1)
332 IF X = 2 AND X$ <> "A" THEN NUM = VAL (NUM$) 
335 NRMAL=1

340 IF X = 1 THEN IF NUM * GP(X1) > C THEN PRINT :LOCATE 1,18
341 IF X = 1 THEN IF NUM * GP(X1) > C THEN PRINT "YOU CAN'T AFFORD SO MUCH! ";
342 IF X = 1 THEN IF NUM * GP(X1) > C THEN GOSUB 760:LOCATE 1,18
343 IF X = 1 THEN IF NUM * GP(X1) > C THEN PRINT A$;:GOTO 300
344 IF X = 1 AND NUM * GP(X1) <= C THEN SG(X1) = SG(X1) + NUM: SH=SH- NUM
345 IF X = 1 AND NUM * GP(X1) <= C THEN C=C - GP(X1) * NUM:GOSUB 130: GOTO 230
350 IF NUM>SG(X1)THENLOCATE1,18:PRINTA$;:LOCATE1,18
351 IF NUM>SG(X1)THEN PRINT"YOU DON'T HAVE THAT MUCH! ";
352 IF NUM > SG(X1) THEN GOSUB 760:LOCATE1,18:PRINT A$ ;:GOTO 300
353 SG(X1) = SG(X1)-NUM:SH=SH + NUM:C = C + (NUM * GP(X1) ) :GOSUB 130:GOTO 230

355 REM OTHER OPTIONS (360-381)
360 GOSUB 130: GOSUB 1340:LOCATE 1,11:INVERS=1:PRINT A$:NRMAL=1:
361 PRINT " T)RADE, R)ECORDS" ; 
363 IF L = 0 THEN PRINT ", L)ENDER, G)ODOWN OR E)MBARK?":PRINT: PRINT A$
365 IF L <> 0 THEN PRINT " OR E)MBARK?": PRINT:PRINT: PRINT A$;
370 GOSUB 60:IF X$ = "G" AND L = 0 THEN X = 1
371 IF X$ = "T" THEN 120
372 IFX$="R"THENX=2
373 IFX$="L"THENX=3
374 IFX$="E"THEN730
375 IF(X$<>"G"ORL<>0)ANDX$<>"T"ANDX$<>"R"ANDX$<>"L"ANDX$<>"E" THEN GOSUB770
376 IF(X$<>"G"ORL<>0)ANDX$<>"T"ANDX$<>"R"ANDX$<>"L"ANDX$<>"E" THEN GOTO370

380 IF X = 3 AND L <> Q THEN GOSUB 770: GOTO 370
381 IF X <> 3 OR L = 0 THEN ON X GOSUB 390,600,470: GOTO 360

384 REM GODOWN SUBROUTINE (390-461)
387 REM GODOWN MENU (390-392)
390 GOSUB130:LOCATE1,13:PRINTA$:LOCATE1,13:PRINT "CARGO <T>O OR <F>ROM GODOWN?"
391 PRINT A$;:GOSUB 60:IF X$= "T" THEN 410
392 IF X$="F" THEN 440
393 IF X$<> "T" AND X$ <> "F" THEN GOSUB 770: GOTO 390

395 REM GODOWN CARGO CHOICE SUBROUTINE (400)
400 LOCATE1,13:PRINT "MOVE WHAT ("TC$")? ": GOSUB 260:RETURN


410 GOSUB 400
411 IF SG(X1)=0 THEN LOCATE1,13:PRINT "YOU HAVE NO ";G$(X1);" ABOARD!        "
412 IF SG(X1) = 0 THEN GOSUB 760:RETURN
420 NUM$="":LOCATE1,13:PRINTA$:LOCATE1,13:PRINT " MOVE HOW MUCH ";G$(X1);"? ";
421 GOSUB305:IF X$="A" THEN INVERS=1:PRINT CHR$(8);"ALL";:NUM = SG(X1):NRMAL=1
422 IF X$ <> "A" THEN NUM = VAL (NUM$)
425 REM TAB(1)
430 IF NUM > SG(X1) THEN LOCATE 1,13: PRINT " ONLY ";:Q = SG(X1):GOSUB 1330
431 IF NUM > SG(X1) THEN PRINT TAB(11);" UNITS ABOARD!    ":GOSUB 760:GOTO 420

432 IFNUM<=SG(X1)THEN SG(X1)=SG(X1)-NUM:SH=SH+NUM:GG(X1)=GG(X1)+NUM:NUM$=""
433 IFNUM<=SG(X1)THEN RETURN
440 GOSUB 400
441 IFGG(X1)=0THENLOCATE1,13:PRINT" THE GODOWN HAS NO ";G$(X1);".           "
442 IF GG(X1) =0 THEN GOSUB 760:RETURN
450 NUM$=""
451 LOCATE1,13:PRINTB$;:PRINTTAB(1)" MOVE HOW MUCH ";G$(X1);" TO SHIP? ";
452 GOSUB305:IFX$="A"THENPRINT CHR$(8);:INVERS=1:PRINT"ALL";:NRMAL=1:NUM=GG(X1)
453 IF X$ <> "A" THEN NUM = VAL (NUM$)
460 IF NUM>GG(X1)THEN LOCATE1,13:PRINT" JUST ";:Q=GG(X1):GOSUB1330
461 IF NUM>GG(X1)THEN PRINT " UNITS STORED!":GOSUB 760: GOTO 450

462 IF NUM < = GG(X1) THEN GG(X1) =GG(X1) - NUM: SG(X1) = SG(X1) + NUM
463 IF NUM < = GG(X1) THEN SH=SH- NUM:NUM$= "":RETURN

465 REM LENDER SUBROUTINE (470-580)
470 GOSUB 130:GOSUB 1340:LOCATE1,12:
471 PRINT "[WANCHAI DISTRICT OF HONGKONG: HOME OF "; W$;"]":PRINT W$;
472 PRINT " GREETS YOU, TAIPAN, AND WISHES YOU WELL.":GOSUB 780
473 LOCATE1, 14:PRINT A$:PRINT A$
480 LOCATE1,14:PRINT "WU STATES THAT HIS IRON LOTUS": 
481 PRINT "TRIAD HAS BEEN WATCHING YOU.": GOSUB 780
490 LOCATE1, 14: PRINT A$: PRINT A$: PRINT A$:VTAB 14:PRINT W$;
491 PRINT " ASKS, DO YOU":PRINT A$;:LOCATE1, 15
492 PRINT "WISH TO B)ORROW, P)AY, OR Q)UIT?    ";: NUM$ = ""
500 GOSUB 60:IF X$ = "B" THEN LD$ = "BORROW": LD = 1
501 IF X$ = "P" THEN LD$ = "PAY": LD = 2
502 IF X$ = "Q" THEN PRINT: GOSUB 1340:RETURN
503 IF X$ <> "B" AND X$ <> "P" AND X$ <> "Q" THEN GOSUB 770: GOTO 500
510 IF LD = 1 AND (B = 1 OR D > 1E4) THEN GOSUB 1340: LOCATE1,15
511 IF LD = 1 AND (B = 1 OR D > 1E4) THENPRINT"WU REGRETS THAT HE CANNOT LOAN":
512 IF LD = 1 AND (B = 1 OR D > 1E4) THENPRINT"YOU MORE AT THIS TIME, TAIPAN.";
513 IF LD = 1 AND (B = 1 OR D > 1E4) THEN GOSUB 760:GOTO 490

520 GOSUB 1340: LOCATE1, 15:PRINT "HOW MUCH DO YOU WISH TO ";LD$;","
521 PRINT "TAIPAN? ";:GOSUB 305:NUM = VAL (NUM$)


530 IFX$="A"ANDLD=1THENPRINTCHR$(8);:INVERS=1:PRINT"ALL";:NRMAL=1:NUM=C*2
532 IFX$="A"ANDLD=2THENPRINTCHR$(8);: INVERS=1:PRINT "ALL";: NRMAL=1:NUM = D
540 IF LD = 2 THEN 560
541 IF NUM>2*C THEN LOCATE1,15:PRINT A$:LOCATE1,15:PRINT W$;" REGRETS THAT HE"
542 IF NUM>2*C THEN PRINT "CANNOT LOAN YOU THAT MUCH.";: GOSUB 760:GOTO 490
550 B=1:C = C + NUM:D = D + NUM: GOSUB 130: GOTO 490
560 IF NUM > C THEN NUM = C: D = D - C:C=0:GOSUB 130:VTAB 15:PRINT W$;
561 IF NUM > C THEN PRINT" THANKS YOU,":PRINT "TAIPAN, FOR THE PAYMENT.";
562 IF NUM > C THEN GOSUB 780:IF D < 0 THEN D = 0:GOSUB 130:GOTO 490
563 IF NUM > C AND D > = 0 THEN GOSUB 130: GOTO 490
570 IF NUM > D THEN D = 0: C = C - NUM:VTAB 15:PRINT W$;
571 IF NUM > D THEN PRINT" THANKS YOU FOR YOUR STARTLING GENEROSITY!";
572 IF NUM > D THEN GOSUB 130:GOSUB 780:GOTO 490
580 C = C - NUM: D = D - NUM:GOSUB 130:VTAB 15
581 PRINTW$;" ACCEPTS YOUR PAYMENT WITH GRATITUDE, TAIPAN";:GOSUB 780:GOTO 490

585 REM RANDOMIZER SUBROUTINE (590-591)
590 LOCATE8,15:PRINT "PRESS <";:FLSH=1:PRINT"SPACEBAR";:NRMAL=1
591 PRINT"> TO START"; : GOSUB 60:IF X$ = " " THEN RETURN
592 X = INT ( RND (1) * 9) + 1: GOTO 590



595 REM RECORDS SUBROUTINE (600-721)
600 LOCATE 1,1: CLS: INVERS=1:PRINT A$;:NRMAL=1
601 PRINT "    RECORDS OF HIGH & LOW PRICES":INVERS=1:PRINT A$;:NRMAL=1:PRINT
602 PRINT "    RECORDS BY P)ORT OR I)TEM? "
603 PRINT"    __________________________"


605 LOCATE1,10: PRINT "    PRESS <SPACEBAR> WHEN FINISHED":PRINT: INVERS=1
606 PRINT A$: NRMAL=1
610 GOSUB 60:IF X$ = "P" THEN GOSUB 720: GOTO 620
611 IF X$ = "I" THEN PRINT: VTAB 5:PRINT A$;: PRINT A$: GOSUB 660: GOTO 670
612 IFX$=" "THENHOME: RETURN
613 IFX$<>"P"ANDX$<>"I" AND X$ <> " " THEN GOSUB 770: GOTO 610



620 GOSUB 60:IF ASC (X$) > 47 AND ASC (X$) < 58 THEN X = VAL(X$)
621 IF ASC (X$) < 48 OR ASC (X$) > 57 THEN GOSUB 770:GOTO 620
630 CLS:PRINT " ";L$(X);" PRICES (VISITS:";V(X);")": INVERS=1
631 PRINT " ITEM              HIGH         LOW     ";:NRMAL=1
632 FOR I = 0 TO 5:PRINT " ";G$(I);:PRINT TAB(21);
640 IFH(X,I)=0THENPRINT" ?";:INV=1:PRINTTAB(30)" ";:NRMAL=1:PRINT"   ?":NEXTI
641 IFH(X,I)<>0THENPRINTTAB(21);H(X,I);:PRINTTAB(30);" ";:PRINT" ";L(X,I):NEXTI

650 INVERS=1: PRINT A$:NRMAL=1: GOTO 700
660 LOCATE1, 5:FOR I = 0 TO 5:PRINT " ";G$(I),:NEXT I:PRINT
661 PRINT " WHAT ITEM (";TC$; "  ?": PRINT:PRINT A$:INVERS=1: PRINT A$: NRMAL=1
662 GOSUB 260: RETURN
670 CLS:PRINT " ";G$(X1);"  PRICES": INVERS=1
671 PRINT " PORT      VISITS     HIGH    LOW       ";:NRMAL=1
672 FOR I = 0 TO 9:PRINT L$(I);

680 LOCATE12, I+3:PRINT V(I);:IF L(I,X1) = 0 THEN HTAB 21: INVERS=1: PRINT " ";
681 IF L(I,X1) = 0 THEN INVERS=1: PRINT TAB(21);" ";: NRMAL=1:PRINT "  ?";: 
682 IF L(I,X1) = 0 THEN PRINT TAB(32);"?":NEXT I:GOTO 690
683 IFL(I,X1)<>0 THEN INVERS=1:PRINT TAB(21);" ";:NRMAL=1:PRINT "  ";H(I,X1) ;
684 IFL(I,X1)<>0 THEN PRINT TAB(31);" ";L(I,X1): NEXT I
690 INVERS=1: PRINT A$:NRMAL=1
700 PRINT " PRESS <SPACEBAR> WHEN FINISHED";
710 GOSUB 60:IF X$ = " " THEN 600
711 GOTO 710
715 REM PORT CHOICE SUBROUTINE (720)
720 FORI=0TO9STEP2: VTAB (I / 2) + 4:PRINT A$:VTAB (I / 2) + 4: 
721 PRINT I;" ";L$(I);: HTAB 20:PRINT I + 1;" ";L$(I+1):NEXT I:PRINT

722 PRINT "       WHICH PORT (0-9)?             ": PRINT:INVERS=1: 
723 PRINT A$: NRMAL=1: RETURN


725 REM EMBARK (730-751)
730 IF SH < 0 THEN LOCATE1,13:PRINT "YOUR SHIP IS OVERLOADED, TAIPAN         ";
731 IF SH < 0 THEN PRINT A$:GOSUB 760:GOTO 360
732 IF SH > = 0 THEN CLS: PRINT TAB( 11);:INVERS=1:PRINT "EMBARKING":NRMAL=1
733 IF SH > = 0 THEN PRINT TAB( 9);"FROM " ;L$ (L ) : INVERS=1:PRINT A$:NRMAL=1
734 IF SH > = 0 THEN FOR I = 0 TO 9:IF L = I THEN NEXT I:GOTO 740
736 IF L <> I THEN PRINT TAB( 10);I;" ";L$(I): NEXT I

740 PRINT:PRINT:INV=1:PRINTA$:NRMAL=1:PRINT"WHAT PORT O' CALL, TAIPAN (0-9)?"

750 GOSUB 60
751 IFASC(X$)>47ANDASC(X$)<58ANDVAL(X$)<>LTHEN PO = VAL (X$) : GOTO 980
752 GOSUB 770: GOTO 750

755 REM NO CAN DO SUBROUTINE (760)

760 PRINT "^G": GOSUB 780:RETURN

765 REM INPUT ERROR SUBROUTINE (770)
770 PRINT "^G";: RETURN


775 REM DELAY SUBROUTINE (780-783)
780 POKE -16368,0
781 FORI=0TO250
782 IF PEEK ( -16364) > 127 THEN POKE -16368,0:RETURN
783 NEXT I: RETURN

785 REM EVENTS SUBROUTINE (790-851)
790 IF K = 1 THEN RETURN
791 K=1:X = 50 + INT ( RND (1) * 100) + 1: GN = INT ( RND (1) * 3) +1
792 XP = (X + (GN * 50)) * 100:IF C < XP OR RND (1) < .75 THEN 805
795 GOSUB 1340: VTAB 12:PRINT " A BROKER OFFERS TO TAKE YOUR"
796 PRINT "VESSEL IN TRADE FOR ONE WITH":PRINTGN+G;" GUNS & ";X+MW;" CAPACITY"




800 PRINT "FOR ";XP;" IN CASH. WILL YOU": PRINT " ACCEPT (<Y> OR <N>)?";
801 GOSUB 60:LOCATE1,12
802 IF X$ = "Y" THEN C = C - XP:SH = SH + X:MW = MW + X:G = G + GN: GOSUB 130
805 GOSUB 1340
810 IFC>DANDD>2000ANDRND(1)>.7THENGOSUB 1340:LOCATE1, 12
811 IFC>DANDD>2000ANDRND(1)>.7THENPRINT"YOU'VE BEEN ATTACKED AND ROBBED BY ";
812 IFC>DANDD>2000ANDRND(1)>.7THENPRINT"IRON LOTUS RUFFIANS, TAIPAN!" ; 
813 IFC>DANDD>2000ANDRND(1)>.7THENC = INT (C / 3) :GOSUB 760:GOSUB 130
820 GOSUB 180: GOSUB 860: GOSUB 190:GOSUB 1340:DN = INT ((C / 2) * RND (1))
821 IFRND(1)>.8ANDTR=0ANDL<>0THENLOCATE1,12:PRINT"A MESSENGER FROM ";LY$;
822 IFRND(1)>.8ANDTR=0ANDL<>0THENPRINT" ASKS"
823 IFRND(1)>.8ANDTR=0ANDL<>0THENPRINT "THAT YOU RETURN TO HONG KONG"

825 IF RND(0)>.8ANDTR=0 AND L<>0 THEN PRINT "WITHOUT DELAY, TAIPAN.":GOSUB780

830 IFC>100ANDTR=0ANDL=0 THEN GOSUB 1340:LOCATE1,12:PRINT YS$;", LIEUTENANTS"
831 IFC>100ANDTR=0ANDL=0 THEN PRINT "OF THE MARINER, ";LY$;", ASK IF"
832 IFC>100ANDTR=0ANDL=0 THEN PRINT "YOU WILL DONATE ";:Q = DN:GOSUB 1330
833 IFC>100ANDTR=0ANDL=0 THEN PRINT "TO THE TEMPLE OF TIN HAU, THE"
835 IF C > 100 AND TR = 0 AND L = 0THEN PRINT "SEA GODDESS. (Y) OR (N)"
840 IFC>0ANDTR=0ANDL=0THENGOSUB60:IFX$="Y"THENC=C-DN:TR=1:GOSUB 130
841 IFC>0ANDTR=0ANDL=0THENGOSUB60:IFX$="Y"THENGOSUB 1340:LOCATE1,12:PRINT " "
842 IFC>0ANDTR=0ANDL=0THENGOSUB60:IFX$="Y"THENPRINT " " ;YS$;" THANK"
843 IFC>0ANDTR=0ANDL=0THENGOSUB60:IFX$="Y"THENPRINT " YOU, AND DEPART."
844 IFC>0ANDTR=0ANDL=0THENGOSUB60:IFX$="Y"THENPRINT:PRINT A$;
846 IFC>0ANDTR=0ANDL=0THENIFX$<>"Y"THENGOSUB1340: LOCATE1,12:PRINT" ":PRINT" ";
847 IFC>0ANDTR=0ANDL=0THENIFX$<>"Y"THENPRINTYS$;" DEPART"
848 IFC>0ANDTR=0ANDL=0THENIFX$<>"Y"THENPRINT "ABRUPTLY IN A CHILLY SILENCE."
849 IFC>0ANDTR=0ANDL=0THENIFX$<>"Y"THENPRINT A$;



850 IF(TR=0ANDL=0) OR X$ = "Y" AND L = 0 THEN PRINT: PRINT A$;:GOSUB 780
851 IF(TR=0ANDL=0) OR X$ = "Y" AND L = 0 THEN LOCATE1,13:PRINT A$:PRINT:PRINT
854 RETURN
855 REM BEARS 'N' BULLS SUBROUTINE (860-910)
860 I = INT ( RND (1) * 6)
870 IF RND (1) < .85 THEN RETURN
880 GP(I) = INT (GP(I) * ( RND (1) * 4) + .5)
890 LOCATE1,12:PRINT L$(L);" MARKET FORCES HAVE": PRINT "DRIVEN ";G$(I);
891 PRINT " PRICES TO ";:PRINT GP(I);: PRINT "!";
900 GOSUB 780
910 RETURN

975 REM VOYAGE (980-1290)
980 CLS: PRINT:INVERS=1:PRINT A$;:NRMAL=1:PRINT " SEA VOYAGE FROM ";L$(L)
981 PRINT " TO ";L$(PO) :INVERS=1: PRINT A$: NRMAL=1: GOSUB 780: CLS
982 ET = ABS (LO(L) - LO(PO))
984 IF INT ( RND (1) * 50) + 1 >INT ( RND (1) * ET) + 1 THEN 1290

985 REM STORM (990-1022)
990 IF RND (1) > .5 THEN 1030
991 LOCATE1, 13: PRINT B$;:HTAB 1:PRINT " STORM, TAIPAN!" : GOSUB 760
1000 IF RND (1) > .2 THEN 1020
1001 LOCATE1, 14:PRINT " ANY PORT IN A STORM,                 ": GOSUB 760
1002 PO = INT ( RND (1) * 10) :IF PO = L THEN LOCATE1, 14
1003 PRINT" WE CAN'T MAKE IT,                      TAIPAN,            "
1004 SR = 0:GOTO 1090
1010 LOCATE1, 14
1011 PRINT " WE'RE HEADED                           FOR SHELTER,          "
1012 GOSUB 780
1020 LOCATE1, 14
1021 PRINT " WE RODE OUT THE                        STORM, TAIPAN!       "
1022 GOSUB 780
1023 IF RND (1) > .5 THEN 990
1024 GOTO 1290



1025 REM PIRATES (1030-1281)
1030 HOME:ID = INT ( RND (1) * 2) + 1:GOSUB 5290
1031 P = INT ( RND (1) * (MW / 25) * 2 ^ (ID*2)) * INT ( RND (1) * 3) + 1
1032 LOCATE1,17:PRINT P;" PIRATE CRAFT SIGHTED!": GOSUB 780:GOSUB 1100
1040 IFID=1THENLOCATE1,19:PRINT" LOOKS LIKE INDEPENDENT PIRATES.": GOSUB 780
1041 IFID<>1THENLOCATE1,19:PRINT B$,:PRINTTAB(1);" THERE'S ";LY$;"'S BANNER!"
1042 IFID<>1THENGOSUB 780
1050 GOSUB 1100
1051 IFID=1ANDRND(1)>.95THENLOCATE1,19:PRINT B$;:PRINT TAB(1)" ";LY$;
1052 IFID=1ANDRND(1)>.95THENPRINT"'S FLEET DROVE 'EM OFF!":GOSUB6100
1053 IFID=1ANDRND(1)>.95THENP=P*INT(RND(1)*10)+6:ID=2:GOSUB 5290:GOSUB 1100
1054 IFID=1ANDRND(1)>.95THENIF TR = 0 THEN 1070
1060 IFID=2ANDTR=1THENLOCATE1,19:PRINT "THEY GREET US, AND SAIL OFF.    "
1061 IFID=2ANDTR=1THENGOSUB 6100:P=0:GOSUB 780:IF RND (1) > .8 THEN 1030
1062 IF ID = 2 AND TR = 1 THEN 1290


1070 IFCR=0ANDTR=0ANDID=2THENCR=1:LOCATE1,19:PRINT B$;:PRINTTAB(1)" ";YS$;
1071 IFCR=0ANDTR=0ANDID=2THENPRINT" ARE CURSING US!": GOSUB 780
1080 LOCATE1,19:PRINT "  THEY'RE FIRING ON US!          ": GOSUB 5380
1081 IFINT(RND(1)*P)+1>INT(RND(1)*5)+1THENGOSUB5540:LOCATE1,19:PRINT B$;
1082 IFINT(RND(1)*P)+1>INT(RND(1)*5)+1THENPRINTTAB(1)" THE BUGGERS HIT US!"
1083 IFINT(RND(1)*P)+1>INT(RND(1)*5)+1THENSR=SR-(RND(1)/(MW/(INT(RND(1)*50)+1)))
1084 IFINT(RND(1)*P)+1>INT(RND(1)*5)+1THENGOSUB 780:GOSUB 1100:GOTO 1090
1085 LOCATE1,19:PRINT " MISSED US, TAIPAN!        ": GOSUB 780

1081 DICE=INT(RND(1)*P)+1>INT(RND(1)*5)+1
1082 IFDICETHENGOSUB5540:LOCATE1,19:PRINT B$;:PRINTTAB(1)" THE BUGGERS HIT US!"
1083 IFDICETHENSR=SR-(RND(1)/(MW/(INT(RND(1)*50)+1)))
1084 IFDICETHENGOSUB 780:GOSUB 1100:GOTO 1090



1090 IFSR<.1THENGOSUB780: LOCATE1,19:PRINT " WE'RE GOING UNDER, TAIPAN!      "
1091 IFSR<.1THENGOSUB 6290:X$= "":GOTO 1300



1092 GOTO 1120
1095 REM SHIP STATUS SUBROUTINE (1100-1110)
1100 LOCATE1,16:INVERS=1:PRINTA$;:NRMAL=1:PRINT" GUNS: ";G;"         REPAIR:";
1101 IF SR<0THENSR=0
1110 PRINT INT (SR * 100);"%  ":PRINT "SHIPS ENCOUNTERED:";P;"       "
1111 PRINT A$;:PRINT A$;:PRINT A$;:RETURN
1120 LOCATE1,19:PRINT " SHALL WE R)UN, F)IGHT, OR P)ARLEY?": GOSUB 60
1121 IF X$ = "R" THEN X = 1
1122 IF X$ = "F" THEN X = 2
1123 IF X$ = "P" THEN X = 3
1124 IF X$ <> "R" AND X$ <> "F" AND X$ <> "P" THEN GOSUB 770:GOTO 1120


1130 ON X GOTO 1140,1160,1200

1140 IF SR<=RND(1)ANDINT(RND(1)*6)+1 < = INT ( RND (1) * P) + 1 THEN 1150
1141 IF SR>RND(1) AND INT(RND(1) * 6) + 1 > INT ( RND (1) * P) + 1 THEN 1143
1142 GOTO 1150
1143 GOSUB 6220: LOCATE1,18:PRINT "WE ESCAPED FROM 'EM TAIPAN!         "
1144 P=0:GOSUB 780:GOSUB 1100:IF RND (1) > .8 THEN 1030
1145 GOTO 1290


1150 DICE=SR>RND(1)ANDRND(1)>.6
1151 IFDICETHENP=P-INT(INT((RND(1)*P)+1)/2):GOSUB6220
1152 IFDICETHENGOSUB 5290:LOCATE1,19:PRINT P;
1153 IFDICETHENPRINT" OF 'EM STILL WITH US!                         "
1154 IFDICETHENGOSUB 780: GOSUB 1100: GOTO 1050


1155 LOCATE1,19:PRINT " CAN'T SHAKE 'EM!                               "
1156 GOSUB 780: GOTO 1050

1160 VTAB 19:PRINT " WE'RE FIRING ON 'EM!               ":GOSUB 5540:IF INT ( RND (1) * (G + 1)) + 1 > INT (RND (1) * 4)THEN VTAB 19:PRINT B$;:HTAB 1:PRINT "HIT 'EM!":GOSUB 5680:GOTO 1170
1161 VTAB 19:PRINT " MISSED 'EM!                        ":GOSUB 780: GOTO 1190
1170 NK = RND (1):IF NK > .4 THEN IF P >= G THEN X = INT ( INT (( RND (1) * (G - 1)) + 1) / 3) + 1
1170 IF NK > 0.4 THEN IF P >= G THEN X = INT ( INT (( RND (1) * (G - 1)) + 1) / 3) + 1
1170 IF NK > 0.4 THEN IF P >= G THEN X = 0
1170 IF NK > .4 THEN IF P >= G THEN X = 0
1170 X = INT ( INT (( RND (1) * (G - 1)) + 1) / 3) + 1
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT (( RND (1) * (G - 1)) + 1) / 3) + 1
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( 0) + 1
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT(0) /3) + 1
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT((0) + 1) /3) + 1
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (0)) + 1) /3) + 1

1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (G)) + 1) /3) + 1 
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (G)) + 1) /3) + 1 : REM GOOD
1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (G - 1)) + 1) /3) + 1

1170 NK = RND (1):IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (G)) + 1) /3) + 1
1170 NK = RND (1):IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (G - 1)) + 1) /3) + 1

1170 IF NK > .4 THEN IF P >= G THEN X = INT ( INT((RND (1) * (G - 1)) + 1) /3) + 1

1170 NK = RND (1): REM GOOD



1171 IF NK > 0.4 AND P < G THEN X = INT ( RND (1) * P)+1


1172 IF NK <= 0.4 THEN VTAB 19:PRINT " THEY'RE STILL AFLOAT.": GOSUB 780:GOTO 1190



1180 P=P-X: VTAB 19:PRINT " SANK ";X;" OF 'EM, TAIPAN!": GOSUB 5830:IF P > 0 THEN GOSUB 5290
1190 GOSUB 1100:IF P = 0 THEN IF RND (1) > .5 THEN 1270
1191 IF P = 0 THEN VTAB 19:PRINT " THAT'S ALL FOR THE BUGGERS!": GOSUB 780:IF RND (1) > .8 THEN 1030
1192 IF P = 0 THEN 1290
1193 GOSUB 780: GOTO 1050
1200 IF RND (1) < .8 THEN VTAB 19:PRINT " THEY REFUSE TO PARLEY, TAIPAN.       ": GOSUB 780:GOTO 1050
1201 VTAB 19:PRINT " THEY AGREE TO DISCUSS TERMS.         ": GOSUB 780



1210 DICE=P > G / 2 OR RND (1) > .7
1211 IFDICETHENLOCATE1,19:PRINT" THEY OFFER TO LET US GO IN EXCHANGE FOR";
1212 IFDICETHENPRINT "ALL OUR CASH. DO WE ACCEPT, TAIPAN (Y/N)";: GOTO 1220




1211 GOTO 1240
1220 GOSUB 60: LOCATE1,19:PRINT A$;:PRINT A$;:LOCATE1,18:
1221 DICE=RND (1) > .2 AND C> 100 + INT ( RND (1) * 2000)
1222 IFX$="Y"THENIFDICETHENP=0:C=0:LOCATE1,19:PRINT" THEY TOOK IT & RAN!"
1223 IFX$="Y"THENIFDICETHEN GOSUB 780:GOSUB 1100:GOTO 1280
1227 IF X$ <> "Y" THEN 1050
1228 C=0: VTAB 19
1229 PRINT " THEY STILL INTEND TO FIGHT!": PRINT:PRINT A$;:GOSUB 780
1230 GOSUB 780: GOTO 1050
1240 LOCATE13,1: PRINT SFL$;
1241 LOCATE1, 19:PRINT " THEY OFFER TO SURRENDER.     ":GOSUB 780
1242 LOCATE1,19:PRINT " DO WE LET THEM GIVE UP (Y/N)?     "
1243 GOSUB 60:IF X$ = "Y" THEN 1260
1250 DICE = RND (1) > .5 AND P > 0
1251 IF DICE THEN E = INT ( RND (1) * P) + 1: P=P-E:GOSUB 6100
1252 IF DICE THEN LOCATE1,19:PRINT B$;:PRINT TAB(1);E;" OF 'EM RAN AWAY!"
1253 IF DICE THEN GOSUB 780:GOSUB 1100:GOSUB 5290:GOTO 1050
1260 DICE=RND (1) > .7
1261 IF DICE THEN LOCATE1,19:PRINT " THEY'RE PREPARING TO ATTACK!   "
1262 IF DICE THEN GOSUB 780:GOTO 1050
1265 REM CAPTURE (1270-1281)




1270 LOCATE1,19:PRINT " WE'VE CAPTURED A BIGGER SHIP!" : GOSUB 760
1271 LOCATE1, 19:PRINT " WE'RE TRANSFERRING TO IT NOW.": GOSUB 780:
1272 G = G + INT ( RND (1) * (G + 1)) + 1
1273 E = SH + INT ( RND (1) * (SH + 150)) + 1: SH = SH + E:MW = MW + E:P=0
1280 IF SR < .1 THEN 1300 
1281 IF P > 0 THEN 1050 
1285 REM ARRIVAL (1290)
1290 CR = 0: SR = 1:L=PO:V(L) = V(L) + 1: B=0:K=0:GOSUB 160:CLS:PRINT:INVERS=1
1291 PRINT A$;: NRMAL=1: PRINT " ARRIVING "; L$(L);" AFTER"
1292 PRINT " A VOYAGE OF ";ET;" DAYS.": INVERS=1:PRINT A$:NRMAL=1
1293 GOSUB 780: HOME:GOTO 120

1295 REM THAT'S ALL FOLKS (1300-1321)
1300 CLS:NW = C - D:Q = NW / GT: VTAB 4: INVERS=1: PRINT A$;: NRMAL=1: PRINT
1301 PRINT "YOUR SCORE, BASED UPON TIME AND YOUR": 
1302 PRINT "NET WORTH (EXCLUDING STOCK) IS ";: GOSUB 1330:INVERS=1: 
1303 PRINT A$: NRMAL=1
1310 IF X$ = "R" THEN PRINT "WOULD YOU LIKE TO PICK UP THIS"
1311 IF X$ = "R" THEN PRINT"GAME WHERE YOU LEFT OFF (Y/N)?"
1312 IF X$ = "R" THEN GOSUB 60:IF X$ = "Y" THEN HOME:GOTO 120
1320 GOSUB 1340: VTAB 10:PRINT A$;: PRINT "DO YOU WISH TO START OVER (Y/N)?"
1321 GOSUB 60:IF X$ = "Y" THEN RUN
1322 END


1325 REM BIG NUMBER SUBROUTINE (1330-1370)
1330 IF ABS (Q) < 1E6 THEN PRINT INT (Q);: NRMAL=1:PRINT "   ": RETURN
1331 IF ABS (Q) < 1E9 THEN Q = Q / 1E6: Q$ = "MIL":GOTO 1335
1332 IF ABS (Q) < 1E12 THEN Q = Q / 1E9: Q$ = "BIL":GOTO 1335
1333 IF ABS (Q) > = 1E12 THEN Q = Q / 1E12: Q$ = "TRL":GOTO 1335
1335 PRINT INT (Q);Q$;: NRMAL=1:PRINT "      "
1337 RETURN


1338 REM CLEANUP SUBROUTINE (1340-1370)
1340 FOR I = 12 TO 18
1345 HTAB 1
1350 VTAB I: PRINT A$;
1360 NEXT I
1365 PRINT: VTAB 12
1370 RETURN

4995 REM SEA ACTION SUBROUTINES (5000-6360)
4997 REM GRAPHICS INITIALIZATION (5000-5120)
5000 DIM CH$(14),CN$(14 )
5005 FOR V1 = 0 TO 12
5010 READ CH$(V1)
5020 CN$(V1) = CH$(V1)
5030 NEXT V1
5040 DATA    "          :             "
5050 DATA    "       -------          "
5060 DATA    "       -------    \:    "
5070 DATA    " :/    -------    \\    "
5075 DATA    " //    -------    \\\   "
5080 DATA    "///    -------    \\\   "
5085 DATA    "///    -------     \\   " 
5090 DATA    "///    -------     :\   " 
5100 DATA    "//     -------     :    "

5105 DATA    "/:     -------    -:-   "
5110 DATA    " :--      :      :000:  "
5111 DATA    ":   \------------/   /  "
5112 DATA    " \                  /   "
5120 RETURN


5290 REM PIRATES ARRIVE (5300-5370)
5300 GOSUB 5950
5305 IF ID <> 1 THEN CH$(0) = "       ===:          "

5310 FOR A = 1 TO 10: VTAB 1:PRINT A$;:NEXT A
5320 FOR A = 1 TO 30
5340 FOR B = 0 TO 13
5350 VTAB B+1: HTAB40-A:PRINT LEFT$ (CH$(B),A),;" ";

5360 NEXT B: NEXT A
5370 RETURN


5380 REM PIRATES FIRE (5360-5440)
5390 FORA=1TOINT(RND(1)*6) + 1
5410 A1 = INT ( RND (1) * 10) + 1
5420 IF A1 = 5 THEN 5410
5430 HTAB 16 + A1: VTAB 11:PRINT "*"
5432 PRINT "^G"
5433 HTAB 16 + A1: VTAB 11:PRINT " "
5435 NEXT A
5440 RETURN

5540 REM CANNON HIT (5550-5560)
5550 PRINT "^G"
5560 RETURN


5680 REM DAMAGE 'EM (5730-5760)
5730 I = INT ( RND (1) * 17) + 2: I1 = INT ( RND (1) * 9) + 2
5740 CH$(I1)=LEFT$(CH$(I1),I - 1)+" "+MID$(CH$(I1),I+1,LEN(CH$(I1)))
5750 HTAB 10: VTABI1+1: PRINT CH$(I1)
5755 GOSUB 780
5760 RETURN


5830 REM PIRATES SINK (5840-5940)
5840 FOR A = 0 TO 12
5850 VTAB A+1: PRINT A$;
5870 FOR A1=0 TO 12-A
5880 VTAB 2+A+A1: HTAB 10:PRINT CH$(A1)
5890 NEXT A1
5910 NEXT A
5920 VTAB 14: PRINT A$;
5930 GOSUB 5950
5940 RETURN


5950 REM REPAIR DAMAGE (5960-5990)
5960 FOR A = 0 TO 13
5970 CH$(A)= CN$(A)

5980 NEXT A
5990 RETURN


6100 REM PIRATES DEPART (6110-6210)
6110 FOR A = 9 TO 0 STEP -1
6130 FOR B = 0 TO 13
6140 HTAB A+ 1: VTABB+1:PRINT CH$(B);" "
6150 NEXT B: NEXT A
6160 FOR A = 22 TO 1 STEP -1
6180 FOR B = 0 TO 13
6190 HTAB 1: VTABB+1:PRINT RIGHT$ (CH$ (B) ,A) ;" "
6200 NEXT B: NEXT A
6210 RETURN


6220 REM WE PULL AWAY (6230-6280)
6230 FOR A = 30 TO 1 STEP -1
6250 FOR B = 0 TO 13
6260 HTAB 40 - A: VTABB+1:PRINT " "; LEFT$ (CH$(B),A); CHR$ (8);" ";
6270 NEXT B: NEXT A
6260 RETURN



6290 REM WE'RE SUNK! (6300-6360)
6300 FOR A = 1 TO 17
6310 FOR B = 1 TO 100: NEXT B
6320 VTAB24:HTAB INT ( RND (1) * 40) + 1: PRINT "O"


6350 NEXT A
6360 RETURN
