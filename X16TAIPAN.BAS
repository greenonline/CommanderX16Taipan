2 REM COMMANDERX16TAIPAN
3 SCREEN 3

5 REM INITIALIZATION (10-50)
11 B$="                                       "
10 A$ = "                                        "
12 W$ = "ELDER BROTHER WU":LY$ = "LI YUEN"
14 YS$ = "YANATO & SMYTHE":TC$ = "O, S, T, A, P, OR R"

20 LOCATE 1,5:INVERS=1:PRINT A$:
21 LOCATE 14,6: PRINT "T A I P A N:":NRMAL=1
22 LOCATE 14,7: PRINT "-----------------"
23 SPEED = 100: LOCATE15,10:PRINT"A  G A M E  I N":
24 PRINT TAB( 16);"C O N T E X T": PRINT:PRINT TAB( 15);"HAYDEN BOOK CO."
25 SPEED = 255:INVERS=1:PRINT TAB(16) A$:NRMAL=1

30 DIM M$(11),G$(5),AP(9,5),GG(5),L(9,5),GP(5),V(9)
31 FOR I = 0 TO 9:READ L$(I):NEXT I
32 FOR I = 0 TO 11: READ M$(I):NEXT I
33 FOR I = 0 TO 5: READ G$(I):NEXT I

40 FOR I = 0 TO 9
41 FOR J = 0 TO 5:READ AP(I,J):AP(I,J) = AP(I,J) * 6 ^ (5 - J): NEXT J
42 NEXT I : GOSUB 180


50 FOR I = 0 TO 9:READ LO(I):NEXT I
51 D = 1000: Y=1860: GT = 1: C=400:MW = 50:SH = MW:SR = 1: G=1:V(0) = 1
52 GOSUB 5000: X$ ="":GOSUB 590:GOTO 120

55 REM GET$ SUBROUTINE (60-64)
60 POKE -16368, 0
61 IF PEEK ( -16384) < 128 THEN 61
62 X$ = CHR$ ( PEEK ( -16384) - 128)
63 POKE -16368, 0
64 RETURN

65 REM INITIALIZATION DATA (70-110)
70 DATA HONGKONG, FOOCHOU, SHANGHAI, NAGASAKI, MANILA
71 DATA SINGAPORE, BATAVIA, SAIGON, CALCUTTA, LIVERPOOL

80 DATA JAN, FEB, MAR, APR, MAY, JUN
81 DATA JUL, AUG, SEP, OCT, NOV, DEC
90 DATA OPIUM, SILK, TEA, ARMS, PEPPER, RICE
100 DATA 8,2,2,4,5,2,8,2,1,8,4,3,9,3
101 DATA 3,6,5,4,6,4,2,8,6,5,3,3,4,7,4,4
102 DATA 2,4,5,4,3,5,3,4,5,5,2,6,3
103 DATA 1,4,5,3,3,1,5,6,3,4,5,3,9,9,1,9,5
110 DATA 21,14,7,0,35,49,56,42,84,200


115 REM MAIN DISPLAY (120-150)
120 GOSUB 130: GOTO 220
130 LOCATE 2,2:PRINT "PORT ";L$(L);: LOCATE 29,2:PRINTM$(M);". ";DA+1;",";Y


140 LOCATE 1,3: INVERS=1:PRINT "CASH ";: Q = C:GOSUB 1330: NRMAL=1
141 LOCATE1,3:PRINT TAB(29);"GUNS ";G: LOCATE 1,4:PRINT "DEBT ";
142 Q = D:GOSUB 1330:LOCATE 29,4:PRINT "HOLD ";: Q = SH:GOSUB 1330
143 LOCATE1,5:INVERS=1:PRINT "GOODS     ABOARD SHIP    HONGKONG GODOWN":NRMAL=1

150 FOR I = 0 TO 5: LOCATE 1,6 + I:PRINT G$(I)
151 LOCATE 12, 6 + I:PRINT CHR$(133);
152 Q=SG(I):GOSUB 1330:LOCATE 27, 6 + I:PRINT CHR$ (133);: Q = GG(I):GOSUB 1330
153 NEXT I
154 INVERS=1: PRINT A$: NRMAL=1: RETURN



155 REM UPDATE SUBROUTINE (160-172)
160 ET = INT (ET + (ET * RND (1) / 3)): GT = GT + ET
161 D = D + INT (D * (ET / 360)):JD = JD + ET
162 IF JD > 360 THEN JD = JD-360: Y=Y+1
163 IFJD<1THENJD=1
170 M=INT((JD - 30) / 30): DA = INT((((JD / 30) -INT(JD/30)))*30)
171 IF RND (1) > 0.95 THEN TR = 0



172 IF M < 0 THEN M = 0
173 RETURN

175 REM PRICE VARIATION SUBROUTINE (180)
180 FOR I = 0 TO 5:GP(I) = INT (AP(L,I) + ( RND (1) * AP(L,I))):NEXT I: RETURN



185 REM HI-LO SUBROUTINE (190-210)
190 FOR I = 0 TO 5:IF GP(I) > H(L,I) THEN H(L,I) = GP(I)
200 IFGP(I)<L(L,I)ORL(L,I)=0THENL(L,I)= GP (I)
210 NEXT I: RETURN

212 REM MARKET (220-350)
217 REM MARKET PRICES (220-221)
220 GOSUB 790: GOSUB 1340:LOCATE 1,12:INVERS=1:
221 PRINT TAB(9) " ";L$(L);" MARKET PRICES ":NRMAL=1:PRINT A$
222 FOR I = 0 TO 4 STEP 2: LOCATE 2,14 + I / 2:PRINT G$(I);
223 PRINT TAB(11); GP(I) ;:PRINT TAB(22); G$(I + 1);
224 PRINT TAB(31);GP(I + 1) :NEXT I
225 REM MARKET MENU (230-244)
230 PRINT: LOCATE 1,19:PRINT " B)UY, S)ELL, L)EAVE, OR R)ETIRE?" 
235 REM MARKET MENU INPUT (240-244)


240 GOSUB 60: IF X$= "B" THEN T$ = "BUY":X=1
241 IF X$= "S" THEN T$ = "SELL":X=2

242 IF X$="L" THEN 360
243 IF X$ = "R" THEN 1300
244 IF X$ <> "B" AND X$ <> "S" AND X$ <> "L" AND X$ <> "R" THEN GOSUB 770:GOTO 240
247 REM ITEM MENU (250)
250 VTAB 18:PRINT A$;:VTAB 18:HTAB 3:PRINT T$;" ";TC$;"?": GOSUB 260:GOTO 280
255 REM ITEM CHOICE SUBROUTINE (260-270)
260 GOSUB 60:IF X$ = "O" THEN X1 = 0
261 IF X$ = "S" THEN X1 = 1
262 IF X$ = "A" THEN X1 = 3 
263 IF X$ = "P" THEN X1 = 4 
265 IF X$ = "R" THEN X1 = 5

266 IF X$ <> "O" AND X$ <> "S" AND X$ <> "T" THEN GOSUB 770: GOTO 260
267 IF X$ <> "A" AND X$ <> "P" AND X$ <> "R" THEN GOSUB 770: GOTO 260


270 RETURN
