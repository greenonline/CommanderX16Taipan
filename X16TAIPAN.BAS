2 REM COMMANDERX16TAIPAN
3 SCREEN 3

5 REM INITIALIZATION (10-50)
11 B$="                                       "
10 A$ = "                                        "
12 W$ = "ELDER BROTHER WU":LY$ = "LI YUEN"
14 YS$ = "YANATO & SMYTHE":TC$ = "O, S, T, A, P, OR R"

20 LOCATE 1,4:INVERS=1:PRINT A$:
21 LOCATE 13,5: PRINT "T A I P A N:":NRMAL=1
22 LOCATE 13,6: PRINT "-----------------"
23 SPEED = 100: LOCATE14,9:PRINT"A  G A M E  I N":
24 PRINT TAB(15);"C O N T E X T": PRINT:PRINT TAB( 14);"HAYDEN BOOK CO."
25 SPEED = 255:INVERS=1:PRINT TAB(15) A$:NRMAL=1

30 DIM M$(11),G$(5),AP(9,5),GG(5),L(9,5),GP(5),V(9)
31 FOR I = 0 TO 9:READ L$(I):NEXT I
32 FOR I = 0 TO 11: READ M$(I):NEXT I
33 FOR I = 0 TO 5: READ G$(I):NEXT I


40 FOR I = 0 TO 9
41 FOR J = 0 TO 5:READ AP(I,J):AP(I,J) = AP(I,J) * 6 ^ (5 - J): NEXT J
42 NEXT I : GOSUB 180
42 NEXT I 
43 GOSUB 180


50 FOR I = 0 TO 9:READ LO(I):NEXT I
51 D = 1000: Y=1860: GT = 1: C=400:MW = 50:SH = MW:SR = 1: G=1:V(0) = 1
52 GOSUB 5000: X$ ="":GOSUB 590:GOTO 120

55 REM GET$ SUBROUTINE (60-64)
60 POKE -16368, 0
61 IF PEEK ( -16384) < 128 THEN 61
62 X$ = CHR$ ( PEEK ( -16384) - 128)
63 POKE -16368, 0
64 RETURN

65 REM INITIALIZATION DATA (70-110)
70 DATA HONGKONG, FOOCHOU, SHANGHAI, NAGASAKI, MANILA
71 DATA SINGAPORE, BATAVIA, SAIGON, CALCUTTA, LIVERPOOL

80 DATA JAN, FEB, MAR, APR, MAY, JUN
81 DATA JUL, AUG, SEP, OCT, NOV, DEC
90 DATA OPIUM, SILK, TEA, ARMS, PEPPER, RICE
100 DATA 8,2,2,4,5,2,8,2,1,8,4,3,9,3
101 DATA 3,6,5,4,6,4,2,8,6,5,3,3,4,7,4,4
102 DATA 2,4,5,4,3,5,3,4,5,5,2,6,3
103 DATA 1,4,5,3,3,1,5,6,3,4,5,3,9,9,1,9,5
110 DATA 21,14,7,0,35,49,56,42,84,200


115 REM MAIN DISPLAY (120-150)
120 GOSUB 130: GOTO 220
130 LOCATE 1,1:PRINT "PORT ";L$(L);: LOCATE 29,2:PRINTM$(M);". ";DA+1;",";Y


140 LOCATE 1,2: INVERS=1:PRINT "CASH ";: Q = C:GOSUB 1330: NRMAL=1
141 LOCATE1,2:PRINT TAB(28);"GUNS ";G: LOCATE 1,3:PRINT "DEBT ";
142 Q = D:GOSUB 1330:LOCATE 28,3:PRINT "HOLD ";: Q = SH:GOSUB 1330
143 LOCATE1,4:INVERS=1:PRINT "GOODS     ABOARD SHIP    HONGKONG GODOWN":NRMAL=1

150 FOR I = 0 TO 5: LOCATE 1,5 + I:PRINT G$(I)
151 LOCATE 11, 5 + I:PRINT CHR$(133);
152 Q=SG(I):GOSUB 1330:LOCATE 26, 5 + I:PRINT CHR$ (133);: Q = GG(I):GOSUB 1330
153 NEXT I
154 INVERS=1: PRINT A$: NRMAL=1: RETURN



155 REM UPDATE SUBROUTINE (160-172)
160 ET = INT (ET + (ET * RND (1) / 3)): GT = GT + ET
161 D = D + INT (D * (ET / 360)):JD = JD + ET
162 IF JD > 360 THEN JD = JD-360: Y=Y+1
163 IFJD<1THENJD=1
170 M=INT((JD - 30) / 30): DA = INT((((JD / 30) -INT(JD/30)))*30)
171 IF RND (1) > 0.95 THEN TR = 0



172 IF M < 0 THEN M = 0
173 RETURN

175 REM PRICE VARIATION SUBROUTINE (180)
180 FOR I = 0 TO 5:GP(I) = INT (AP(L,I) + ( RND (1) * AP(L,I))):NEXT I: RETURN



185 REM HI-LO SUBROUTINE (190-210)
190 FOR I = 0 TO 5:IF GP(I) > H(L,I) THEN H(L,I) = GP(I)
200 IFGP(I)<L(L,I)ORL(L,I)=0THENL(L,I)= GP (I)
210 NEXT I: RETURN

212 REM MARKET (220-350)
217 REM MARKET PRICES (220-221)
220 GOSUB 790: GOSUB 1340:LOCATE 1,11:INVERS=1:
221 PRINT TAB(8) " ";L$(L);" MARKET PRICES ":NRMAL=1:PRINT A$
222 FOR I = 0 TO 4 STEP 2: LOCATE 1,13 + I / 2:PRINT G$(I);
223 PRINT TAB(10); GP(I) ;:PRINT TAB(21); G$(I + 1);
224 PRINT TAB(30);GP(I + 1) :NEXT I
225 REM MARKET MENU (230-244)
230 PRINT: LOCATE 1,18:PRINT " B)UY, S)ELL, L)EAVE, OR R)ETIRE?" 
235 REM MARKET MENU INPUT (240-244)


240 GOSUB 60: IF X$= "B" THEN T$ = "BUY":X=1
241 IF X$= "S" THEN T$ = "SELL":X=2

242 IF X$="L" THEN 360
243 IF X$ = "R" THEN 1300
244 IF X$<>"B" AND X$<>"S" AND X$<>"L" AND X$<>"R" THEN GOSUB 770:GOTO 240
247 REM ITEM MENU (250)
250 LOCATE 1,18:PRINT A$;:LOCATE 3,18:PRINT T$;" ";TC$;"?": GOSUB 260:GOTO 280
255 REM ITEM CHOICE SUBROUTINE (260-270)
260 GOSUB 60:IF X$ = "O" THEN X1 = 0
261 IF X$ = "S" THEN X1 = 1
262 IF X$ = "A" THEN X1 = 3 
263 IF X$ = "P" THEN X1 = 4 
265 IF X$ = "R" THEN X1 = 5

268 IFX$<>"O"ANDX$<>"S"ANDX$<>"T"ANDX$<>"A"ANDX$<>"P"ANDX$<>"R"THENGOSUB770
269 IFX$<>"O"ANDX$<>"S"ANDX$<>"T"ANDX$<>"A"ANDX$<>"P"ANDX$<>"R"THEN GOTO260


270 RETURN

280 IF X=1 AND GP(X1) > C THEN LOCATE 1,18
281 IF X=1 AND GP(X1) > C THEN PRINT "YOU CAN'T AFFORD ANY ";G$(X1);". ";
282 IF X=1 AND GP(X1) > C THEN GOSUB 760:GOTO 230

290 IF X = 2 AND SG(X1) < 1 THEN LOCATE 1,18
291 IF X = 2 AND SG(X1) < 1 THEN PRINT "YOU HAVE NO ";G$(X1); " ABOARD!      ";
292 IF X = 2 AND SG(X1) < 1 THEN GOSUB 760:GOTO 230
300 LOCATE 1,18: PRINT A$;:LOCATE 1,18:PRINT T$;" HOW MUCH ";G$(X1);
301 PRINT "? ";:NUM$ = "":NUM = 0:GOSUB 305:GOTO 320
305 REM SOOPER DOOPER NUMBER SCOOPER SUBROUTINE (310-314)
306 PRINT CHR$ (8);: INVERS=1:PRINT " ";:NRMAL=1:GOSUB 60
307 IF LEN(NUM$) > 0 AND ASC(X$) = 8 THEN PRINT X$;: PRINT" "; 
308 IF LEN(NUM$) > 0 AND ASC(X$) = 8 THEN PRINT X$;X$;:PRINT" ";:FG=1
309 IF LEN(NUM$) > 0 AND ASC(X$) = 8 AND LEN(NUM$) = 1 THEN NUM$ = "": FG = 0
310 IF LEN(NUM$) > 0 AND ASC(X$) = 8 AND LEN(NUM$) = 1 THEN GOTO 305

311 IF FG = 1 THEN NUM$ = LEFT$ (NUM$, LEN (NUM$) - 1):FG = 0: GOTO 305
312 IF ASC (X$) = 65 OR ASC (X$) = 13 THEN RETURN
313 IF ASC (X$) < 48 OR ASC (X$) > 57 THEN 305
314 NUM$ = NUM$ + X$: PRINT CHR$ (8);X$; 
315 INVERS=1:PRINT " ";:NRMAL=1: GOTO 305
320 IF X= 1 THEN IF X$ = "A" THEN PRINT CHR$ (8);: INVERS=1
321 IF X= 1 THEN IF X$ = "A" THEN PRINT "ALL"; :NUM = INT (C / GP(X1))
322 IF X = 1 AND X$ <> "A" THEN NUM = VAL (NUM$)
330 IF X = 2 THEN IF X$ = "A" THEN PRINT CHR$ (8) ; : INVERS=1
331 IF X = 2 THEN IF X$ = "A" THEN PRINT "ALL";:NUM = SG(X1)
332 IF X = 2 AND X$ <> "A" THEN NUM = VAL (NUM$) 
335 NRMAL=1

340 IF X = 1 THEN IF NUM * GP(X1) > C THEN PRINT :LOCATE 1,18
341 IF X = 1 THEN IF NUM * GP(X1) > C THEN PRINT "YOU CAN'T AFFORD SO MUCH! ";
342 IF X = 1 THEN IF NUM * GP(X1) > C THEN GOSUB 760:LOCATE 1,18
343 IF X = 1 THEN IF NUM * GP(X1) > C THEN PRINT A$;:GOTO 300
344 IF X = 1 AND NUM * GP(X1) <= C THEN SG(X1) = SG(X1) + NUM: SH=SH- NUM
345 IF X = 1 AND NUM * GP(X1) <= C THEN C=C - GP(X1) * NUM:GOSUB 130: GOTO 230
350 IF NUM>SG(X1)THENLOCATE1,18:PRINTA$;:LOCATE1,18
351 IF NUM>SG(X1)THEN PRINT"YOU DON'T HAVE THAT MUCH! ";
352 IF NUM > SG(X1) THEN GOSUB 760:LOCATE1,18:PRINT A$ ;:GOTO 300
353 SG(X1) = SG(X1)-NUM:SH=SH + NUM:C = C + (NUM * GP(X1) ) :GOSUB 130:GOTO 230

355 REM OTHER OPTIONS (360-381)
360 GOSUB 130: GOSUB 1340:LOCATE 1,11:INVERS=1:PRINT A$:NRMAL=1:
361 PRINT " T)RADE, R)ECORDS" ; 
363 IF L = 0 THEN PRINT ", L)ENDER, G)ODOWN OR E)MBARK?":PRINT: PRINT A$
365 IF L <> 0 THEN PRINT " OR E)MBARK?": PRINT:PRINT: PRINT A$;
370 GOSUB 60:IF X$ = "G" AND L = 0 THEN X = 1
371 IF X$ = "T" THEN 120
372 IFX$="R"THENX=2
373 IFX$="L"THENX=3
374 IFX$="E"THEN730
375 IF(X$<>"G"ORL<>0)ANDX$<>"T"ANDX$<>"R"ANDX$<>"L"ANDX$<>"E" THEN GOSUB770
376 IF(X$<>"G"ORL<>0)ANDX$<>"T"ANDX$<>"R"ANDX$<>"L"ANDX$<>"E" THEN GOTO370

380 IF X = 3 AND L <> Q THEN GOSUB 770: GOTO 370
381 IF X <> 3 OR L = 0 THEN ON X GOSUB 390,600,470: GOTO 360

384 REM GODOWN SUBROUTINE (390-461)
387 REM GODOWN MENU (390-392)
390 GOSUB130:LOCATE1,13:PRINTA$:LOCATE1,13:PRINT "CARGO <T>O OR <F>ROM GODOWN?"
391 PRINT A$;:GOSUB 60:IF X$= "T" THEN 410
392 IF X$="F" THEN 440
393 IF X$<> "T" AND X$ <> "F" THEN GOSUB 770: GOTO 390

395 REM GODOWN CARGO CHOICE SUBROUTINE (400)
400 LOCATE1,13:PRINT "MOVE WHAT ("TC$")? ": GOSUB 260:RETURN


410 GOSUB 400
411 IF SG(X1)=0 THEN LOCATE1,13:PRINT "YOU HAVE NO ";G$(X1);" ABOARD!        "
412 IF SG(X1) = 0 THEN GOSUB 760:RETURN
420 NUM$="":LOCATE1,13:PRINTA$:LOCATE1,13:PRINT " MOVE HOW MUCH ";G$(X1);"? ";
421 GOSUB305:IF X$="A" THEN INVERS=1:PRINT CHR$(8);"ALL";:NUM = SG(X1):NRMAL=1
422 IF X$ <> "A" THEN NUM = VAL (NUM$)
425 REM TAB(1)
430 IF NUM > SG(X1) THEN LOCATE 1,13: PRINT " ONLY ";:Q = SG(X1):GOSUB 1330
431 IF NUM > SG(X1) THEN PRINT TAB(11);" UNITS ABOARD!    ":GOSUB 760:GOTO 420

432 IFNUM<=SG(X1)THEN SG(X1)=SG(X1)-NUM:SH=SH+NUM:GG(X1)=GG(X1)+NUM:NUM$=""
433 IFNUM<=SG(X1)THEN RETURN
440 GOSUB 400
441 IFGG(X1)=0THENLOCATE1,13:PRINT" THE GODOWN HAS NO ";G$(X1);".           "
442 IF GG(X1) =0 THEN GOSUB 760:RETURN
450 NUM$=""
451 LOCATE1,13:PRINTB$;:PRINTTAB(1)" MOVE HOW MUCH ";G$(X1);" TO SHIP? ";
452 GOSUB305:IFX$="A"THENPRINT CHR$(8);:INVERS=1:PRINT"ALL";:NRMAL=1:NUM=GG(X1)
453 IF X$ <> "A" THEN NUM = VAL (NUM$)
460 IF NUM>GG(X1)THEN LOCATE1,13:PRINT" JUST ";:Q=GG(X1):GOSUB1330
461 IF NUM>GG(X1)THEN PRINT " UNITS STORED!":GOSUB 760: GOTO 450

462 IF NUM < = GG(X1) THEN GG(X1) =GG(X1) - NUM: SG(X1) = SG(X1) + NUM
463 IF NUM < = GG(X1) THEN SH=SH- NUM:NUM$= "":RETURN

465 REM LENDER SUBROUTINE (470-580)
470 GOSUB 130:GOSUB 1340:LOCATE1,12:
471 PRINT "[WANCHAI DISTRICT OF HONGKONG: HOME OF "; W$;"]":PRINT W$;
472 PRINT " GREETS YOU, TAIPAN, AND WISHES YOU WELL.":GOSUB 780
473 LOCATE1, 14:PRINT A$:PRINT A$
480 LOCATE1,14:PRINT "WU STATES THAT HIS IRON LOTUS": 
481 PRINT "TRIAD HAS BEEN WATCHING YOU.": GOSUB 780
490 LOCATE1, 14: PRINT A$: PRINT A$: PRINT A$:VTAB 14:PRINT W$;
491 PRINT " ASKS, DO YOU":PRINT A$;:LOCATE1, 15
492 PRINT "WISH TO B)ORROW, P)AY, OR Q)UIT?    ";: NUM$ = ""
500 GOSUB 60:IF X$ = "B" THEN LD$ = "BORROW": LD = 1
501 IF X$ = "P" THEN LD$ = "PAY": LD = 2
502 IF X$ = "Q" THEN PRINT: GOSUB 1340:RETURN
503 IF X$ <> "B" AND X$ <> "P" AND X$ <> "Q" THEN GOSUB 770: GOTO 500
510 IF LD = 1 AND (B = 1 OR D > 1E4) THEN GOSUB 1340: LOCATE1,15
511 IF LD = 1 AND (B = 1 OR D > 1E4) THENPRINT"WU REGRETS THAT HE CANNOT LOAN":
512 IF LD = 1 AND (B = 1 OR D > 1E4) THENPRINT"YOU MORE AT THIS TIME, TAIPAN.";
513 IF LD = 1 AND (B = 1 OR D > 1E4) THEN GOSUB 760:GOTO 490

520 GOSUB 1340: LOCATE1, 15:PRINT "HOW MUCH DO YOU WISH TO ";LD$;","
521 PRINT "TAIPAN? ";:GOSUB 305:NUM = VAL (NUM$)


530 IFX$="A"ANDLD=1THENPRINTCHR$(8);:INVERS=1:PRINT"ALL";:NRMAL=1:NUM=C*2
532 IFX$="A"ANDLD=2THENPRINTCHR$(8);: INVERS=1:PRINT "ALL";: NRMAL=1:NUM = D
540 IF LD = 2 THEN 560
541 IF NUM>2*C THEN LOCATE1,15:PRINT A$:LOCATE1,15:PRINT W$;" REGRETS THAT HE"
542 IF NUM>2*C THEN PRINT "CANNOT LOAN YOU THAT MUCH.";: GOSUB 760:GOTO 490
550 B=1:C = C + NUM:D = D + NUM: GOSUB 130: GOTO 490
560 IF NUM > C THEN NUM = C: D = D - C:C=0:GOSUB 130:VTAB 15:PRINT W$;
561 IF NUM > C THEN PRINT" THANKS YOU,":PRINT "TAIPAN, FOR THE PAYMENT.";
562 IF NUM > C THEN GOSUB 780:IF D < 0 THEN D = 0:GOSUB 130:GOTO 490
563 IF NUM > C AND D > = 0 THEN GOSUB 130: GOTO 490
570 IF NUM > D THEN D = 0: C = C - NUM:VTAB 15:PRINT W$;
571 IF NUM > D THEN PRINT" THANKS YOU FOR YOUR STARTLING GENEROSITY!";
572 IF NUM > D THEN GOSUB 130:GOSUB 780:GOTO 490
580 C = C - NUM: D = D - NUM:GOSUB 130:VTAB 15
581 PRINTW$;" ACCEPTS YOUR PAYMENT WITH GRATITUDE, TAIPAN";:GOSUB 780:GOTO 490

585 REM RANDOMIZER SUBROUTINE (590-591)
590 LOCATE8,15:PRINT "PRESS <";:FLSH=1:PRINT"SPACEBAR";:NRMAL=1
591 PRINT"> TO START"; : GOSUB 60:IF X$ = " " THEN RETURN
592 X = INT ( RND (1) * 9) + 1: GOTO 590



595 REM RECORDS SUBROUTINE (600-721)
